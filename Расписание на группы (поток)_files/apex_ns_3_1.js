var NameSpaceOnly=false;var apex={};if(apex===null||typeof(apex)!="object"){apex={}}if(apex.page===null||typeof(apex.page)!="object"){apex.page={}}if(apex.tabular===null||typeof(apex.tabular)!="object"){apex.tabular={}}if(apex.spreadsheet===null||typeof(apex.spreadsheet)!="object"){apex.spreadsheet={}}if(apex.items===null||typeof(apex.items)!="object"){apex.items={}}if(apex.util===null||typeof(apex.util)!="object"){apex.util={}}if(apex.ajax===null||typeof(apex.ajax)!="object"){apex.ajax={}}if(apex.dhtml===null||typeof(apex.dhtml)!="object"){apex.dhtml={}}if(apex.worksheet===null||typeof(apex.worksheet)!="object"){apex.worksheet={}}if(apex.validation===null||typeof(apex.validation)!="object"){apex.validation={}}if(apex.widget===null||typeof(apex.widget)!="object"){apex.widget={}}apex={util:function(){var a=this;this.el=false;this.init=function(b){a.el=$x(b);if(!a.el){return false}};this.select={};this.select.clean=function(b){a.init(b);if(a.el.length==1&&a.el.options[0].value=="DELETE ME"){a.el.length--}};return a}};var gUtil=new apex.util();apex.page={form:function(b){var a=this;a.request=b;a.supress=false;a.submit=function(c){if(c){a.request=c}if(!a.supress){flowSelectAll();$s("pRequest",a.request);document.wwv_flow.submit()}};this.confirm=function(d,c){if(!!!c){c="Delete"}a.supress=!confirm((!!!d)?"Would you like to perform this delete action?":d);a.submit(c)}},item:function(a){var c=this;this.node=false;this.item_type=false;this.id=false;this.value=d;this.valueArray=b;this.init=e;this.set=f;this.init(a);return;function e(h){try{switch(typeof(h)){case"string":c.node=document.getElementById(h);break;case"object":c.node=h;break;default:c.node=false;break}if(c.node.nodeType==1){}else{c.node=false}}catch(l){c.node=false}if(c.node){c.id=c.node.id;var j=c.node.nodeName.toUpperCase();var k=c.node.className.toUpperCase();if(j=="FIELDSET"){c.item_type=k;switch(k){case"CHECKBOX_GROUP":break;case"RADIO_GROUP":break;case"SHUTTLE":break;case"LISTMANAGER":break;default:c.item_type=false;break}}else{if(j=="INPUT"){c.item_type=c.node.type.toUpperCase();switch(c.item_type){case"CHECKBOX":break;case"RADIO":break;case"TEXT":var g=c.node.parentNode.className.toUpperCase();switch(g){case"LOV":c.item_type=g;break;case"COLORPICKER":c.item_type=g;break;case"CALCULATOR":c.item_type=g;break;case"DATEPICKER":c.item_type=g;break;default:break}break;case"PASSWORD":break;case"HIDDEN":break;case"FILE":break;default:c.item_type=false;break}}else{c.item_type=j;switch(c.item_type){case"TEXTAREA":if(c.node.parentNode.className=="html_editor"&&c.node.parentNode.tagName=="FIELDSET"){c.item_type="FCKEDITOR"}break;case"SELECT":break;case"SPAN":c.item_type=false;break;default:c.item_type=false;break}}}}}function b(){if(!c.node){return false}var l=true,m=[];switch(c.item_type){case"RADIO_GROUP":h=$x_FormItems(c.node,"RADIO");for(var j=0,g=h.length;j<g;j++){if(h[j].checked){m[m.length]=h[j].value}}break;case"CHECKBOX_GROUP":h=$x_FormItems(c.node,"CHECKBOX");for(var j=0,g=h.length;j<g;j++){if(h[j].checked){m[m.length]=h[j].value}}break;case"SHUTTLE":h=$x(c.node.id+"_RIGHT").options;for(var j=0,g=h.length;j<g;j++){m[m.length]=h[j].value}break;case"LISTMANAGER":h=$x(c.node.id+"_LISTMGRDATA").options;for(var j=0,g=h.length;j<g;j++){m[m.length]=h[j].value}break;case"SELECT":var h=c.node.options;for(var j=0,g=h.length;j<g;j++){if(h[j].selected){m[m.length]=h[j].value}}break;default:m=[false];l=false;break}if(l){}else{switch(c.item_type){case"CHECKBOX":m=[(c.node.checked)?c.node.value:false];break;case"RADIO":m=[(c.node.checked)?c.node.value:false];break;case"TEXT":m=[c.node.value];break;case"LOV":m=[c.node.value];break;case"COLORPICKER":m=[c.node.value];break;case"CALCULATOR":m=[c.node.value];break;case"DATEPICKER":m=[c.node.value];break;case"PASSWORD":m=[c.node.value];break;case"HIDDEN":m=[c.node.value];break;case"FILE":m=[c.node.value];break;case"TEXTAREA":m=[c.node.value];break;case"FCKEDITOR":var k=FCKeditorAPI.GetInstance(c.node.id);m=[k.GetHTML()];break;default:m=[false];break}}return m}function d(){lReturn=c.valueArray();lReturn=$u_ArrayToString(lReturn,":");return lReturn}function f(k){var j=false;if(!c.node){return}switch(c.item_type){case"RADIO_GROUP":j=$x_FormItems(c.node,"RADIO");break;case"CHECKBOX_GROUP":j=$x_FormItems(c.node,"CHECKBOX");break;case"LISTMANAGER":j=$x(c.node.id+"_LISTMGRDATA").options;break;case"SELECT":var j=c.node.options;break;default:j=false;break}if(j){for(var l=0,h=j.length;l<h;l++){var g=(j[l].value==k)?true:false;if(c.item_type=="RADIO_GROUP"||c.item_type=="CHECKBOX_GROUP"){j[l].checked=g}else{j[l].selected=g}}}else{switch(c.item_type){case"CHECKBOX":(c.node.value==k)?c.node.checked=true:null;case"RADIO":(c.node.value==k)?c.node.checked=true:null;case"TEXT":c.node.value=k;break;case"LOV":c.node.value=k;break;case"COLORPICKER":c.node.value=k;break;case"CALCULATOR":c.node.value=k;break;case"DATEPICKER":c.node.value=k;break;case"PASSWORD":c.node.value=k;break;case"HIDDEN":c.node.value=k;break;case"FILE":c.node.value=k;break;case"TEXTAREA":c.node.value=k;break;case"FCKEDITOR":var m=FCKeditorAPI.GetInstance(c.node.id);m.SetHTML(k);break;default:c.node.innerHTML=k;break}if(c.node.getAttribute("onchange")||c.node.onchange){c.node.onchange()}}}return}};apex.validation={v:function(){var a=this;this.get_emptys=function(e,j,d){var g=[];var c=[];if($x(e)){e=[e]}for(var f=0,b=e.length;f<b;f++){var h=$x(e[f]);if(h){if(isEmpty(h)){g[g.length]=h}else{c[c.length]=h}}}if(j){$x_Class(g,j)}if(d){$x_Class(c,d)}if(g.length==0){g=false}else{g[0].focus()}return g};this.is_in=function(e,d){var g=[];var c=[];if($x(e)){e=[e]}for(var f=0,b=e.length;f<b;f++){var j=$x(e[f]);for(var h=0,b=d.length;h<b;h++){if(j){if(j.value==d[h]){g[g.length]=j}}}}if(g.length==0){g=false}else{g[0].focus()}return g};this.basic_sql=function(d,e,g,c,b){var f=[d,e,g];if(!!($f_is_in(e,["is null","is not null"]))){f=[d,e]}return $f_get_emptys(f,c,b)}}};function $d_LOV_from_JSON(){var b=this;this.l_Type=false;this.l_Json=false;this.l_This=false;this.l_JSON=false;this.l_Id="json_temp";this.l_NewEls=[];this.create=a;this.l_Dom=false;return;function a(j,g,l,q){var d=$u_eval("("+g+")");if(b.l_Type=="SHUTTLE"){var v='<table cellspacing="0" cellpadding="0" border="0" class="ajax_shuttle" summary=""><tbody><tr><td class="shuttleSelect1" id="shuttle1"></td><td align="center" class="shuttleControl"><img title="Reset" alt="Reset" onclick="g_Shuttlep_v01.reset();" src="/i/htmldb/icons/shuttle_reload.png"/><img title="Move All" alt="Move All" onclick="g_Shuttlep_v01.move_all();" src="/i/htmldb/icons/shuttle_last.png"/><img title="Move" alt="Move" onclick="g_Shuttlep_v01.move();" src="/i/htmldb/icons/shuttle_right.png"/><img title="Remove" alt="Remove" onclick="g_Shuttlep_v01.remove();" src="/i/htmldb/icons/shuttle_left.png"/><img title="Remove All" alt="Remove All" onclick="g_Shuttlep_v01.remove_all();" src="/i/htmldb/icons/shuttle_first.png"/></td><td class="shuttleSelect2" id="shuttle2"></td><td class="shuttleSort2"><img title="Top" alt="Top" onclick="g_Shuttlep_v01.sort2(\'T\');" src="/i/htmldb/icons/shuttle_top.png"/><img title="Up" alt="Up" onclick="g_Shuttlep_v01.sort2(\'U\');" src="/i/htmldb/icons/shuttle_up.png"/><img title="Down" alt="Down" onclick="g_Shuttlep_v01.sort2(\'D\');" src="/i/htmldb/icons/shuttle_down.png"/><img title="Bottom" alt="Bottom" onclick="g_Shuttlep_v01.sort2(\'B\');" src="/i/htmldb/icons/shuttle_bottom.png"/></td></tr></tbody></table>';$x(j).innerHTML=v;var n=$dom_AddTag("shuttle1","select");var t=$dom_AddTag("shuttle2","select");n.multiple=true;t.multiple=true;for(var s=0,u=d.row.length;s<u;s++){if(!!d.row[s]){var r=(!!d.row[s].C)?parseInt(d.row[s].C):false;if(r){var k=$dom_AddTag(t,"option")}else{var k=$dom_AddTag(n,"option")}k.text=d.row[s].D;k.value=d.row[s].R}}window.g_Shuttlep_v01=null;if(!c){var c=[]}c[2]=n;c[1]=t;window.g_Shuttlep_v01=new dhtml_ShuttleObject(n,t);return window.g_Shuttlep_v01}else{if(b.l_Type=="SELECT"||b.l_Type=="MULTISELECT"){var n=$dom_AddTag(j,"select");for(var s=0,u=d.row.length;s<u;s++){if(!!d.row[s]){var k=$dom_AddTag(n,"option");k.text=d.row[s].D;k.value=d.row[s].R;var r=parseInt(d.row[s].C);k.selected=r}}b.l_Dom=n;return b}else{if(b.l_Type=="CHECKBOX"){var e=$dom_AddTag(j,"table");for(var s=0,u=d.row.length;s<u;s++){if(!!d.row[s]){if(s%10==0){lrow=$dom_AddTag(e,"tr")}var f=$dom_AddTag(lrow,"td");var r=parseInt(d.row[s].C);var h=$dom_AddInput(f,"checkbox",d.row[s].R);h.checked=r;$dom_AddTag(f,"span",d.row[s].D)}}b.l_Dom=n;return b}else{var m=$dom_AddTag(j,"div");for(var s=0,u=d.row.length;s<u;s++){if(!!d.row[s]){var o=(!!d.row[s].D)?d.row[s].D:d.row[s].R;var w=$dom_AddTag(m,b.l_Type.toUpperCase(),o);b.l_NewEls[b.l_NewEls.length]=w;w.id=d.row[s].R;var r=parseInt(d.row[s].C);if(r){w.className="checked"}}}b.l_Dom=m;return b}}}}}apex.worksheet={ws:function(a){var b=this;this.ajax_busy=false;this.worksheet_id=false;this.report_id=false;this.current_col_id=false;this.last_col_id=false;this.current_control=false;this.active_dialog=false;this.supress_update=false;this.external_items=false;this.init=c;this.init(a);this.toggle_controls=function(){var d=($x("apexir_CONTROL_PANEL_COMPLETE").style.display!="none")?"Y":"N";$x_ToggleWithImage("apexir_CONTROLS_IMAGE",["apexir_CONTROL_PANEL_COMPLETE","apexir_CONTROL_PANEL_SUMMARY"]);b.supress_update=true;b.action("CONTROL_MIN",false,false,d)};this.item={};this.item.worksheet_holder=function(){return $x("apexir_WORKSHEET_REGION")};this.item.worksheet_detail=function(){return $x("apexir_DETAIL")};this.item.worksheet_report=function(){return $x("apexir_REPORT")};this.item.worksheet_div=function(){return $x("apexir_WORKSHEET")};this.item.control_panel_drop=function(){return $x("apexir_CONTROL_PANEL_DROP")};this.item.ws_control_panel=function(){return $x("apexir_CONTROL_PANEL")};this.item.worksheet_id=function(){return $x("apexir_NUM_ROWS")};this.item.search=function(){return $x("apexir_SEARCH")};this.item.search_column=function(){return $x("apexir_CURRENT_SEARCH_COLUMN")};this.dialog={};this.dialog.check=function(g){var f=html_GetTarget(g);var d=$x("apexir_rollover");var h=true;while(f.nodeName!="BODY"){f=f.parentNode;if(f==d){h=false}}if(h){b.dialog.reset()}};this.dialog.check2=function(g){var f=html_GetTarget(g);var d=$x("apexir_col_values_drop");var h=true;while(f.nodeName!="BODY"){f=f.parentNode;if(f==d){h=false}}if(h){$x_Remove("apexir_col_values_drop")}};this.dialog.reset=function(){if(b.supress_update){}else{$d_ClearAndHide(["searchdrop",b.item.control_panel_drop(),"apexir_SEARCHDROP"]);$x_Hide(["searchdrop","apexir_rollover"]);$s("apexir_rollover_content","");if($x(b.last_col_id)){$x_Class($x(b.last_col_id).parentNode,"")}b.dialog.id=false;document.body.onclick=""}};this.dialog.util_exp_type=function(){var d={};d.col=$x("apexir_COLUMN_NAME");d.col_type=d.col.options[d.col.selectedIndex].className;d.col_opt=$x("apexir_"+d.col_type+"_OPT");d.col_opt_val=$v(d.col_opt);if(d.col_type=="DATE"&&!(d.col_opt_val=="is in the last"||d.col_opt_val=="is not in the last"||d.col_opt_val=="is in the next"||d.col_opt_val=="is not in the next")){d.form_items=["apexir_BETWEEN_FROM","apexir_BETWEEN_TO"]}else{d.form_items=["apexir_EXPR","apexir_EXPR2"]}return d};this.dialog.validate=function(f){var e=[];var d=b.dialog.util_exp_type();switch(true){case (d.col_opt_val=="between"):e=[d.form_items[0],d.form_items[1]];break;case (d.col_opt_val=="is null"||d.col_opt_val=="is not null"):e=[];break;case (d.col_opt_val=="is in the last"||d.col_opt_val=="is not in the last"||d.col_opt_val=="is in the next"||d.col_opt_val=="is not in the next"):e=[d.form_items[0],"apexir_EXPR3"];break;default:e=[d.form_items[0]]}if($f_get_emptys(e,"error","")){return false}else{return d}};this.controls={};this.controls.cancel=function(){b.dialog.reset()};this.controls.save_toggle=function(e){var d=($v(e)=="NAMED")?"apexir_SAVE_NAMED":"apexir_SAVE_DEFAULT";$x_HideSiblings(d)};this.controls.drop=function(){return b.item.control_panel_drop()};this.controls.get=function(e,d){b.dialog.reset();b.l_Action="CONTROL";b.l_Type=e;b.current_control=e;b.current_dom=$x(d);if(d){b.current_col_id=d}b._Get("CONTROL",e,false,d)};this.controls.menu=function(e,d){b.dialog.reset();app_AppMenuMultiOpenBottom2(e,d,false)};this.controls.init=function(d){};this.controls.widget=function(d){this.get("SORT_WIDGET",d);b.current_col_dom=$x(d);document.body.onclick=b.dialog.check};this.controls.narrow=function(d){b.supress_update=true;b.temp_return_element=$x(d);this.get("NARROW",$v("apexir_COLUMN_NAME"))};this.controls.format_mask=function(d){b.supress_update=true;b.temp_return_element=$x(d);this.get("FORMAT_MASK_LOV")};this.controls.col_lov=function(d){this.get("COL_LOV",d)};this.controls.filter=function(d){this.get("SHOW_FILTER",d)};this.controls.filter2=function(){b.controls.set=true;this.get("SHOW_FILTER")};this.controls.display_column=function(d){this.get("SHOW_COLUMN",d)};this.controls.search_column=function(d){this.get("SEARCH_COLUMN",d)};this.controls.highlight=function(d){this.get("SHOW_HIGHLIGHT",d)};this.controls.ordering=function(d){this.get("SHOW_ORDERING",d)};this.controls.save=function(d){this.get("SAVE_REPORT",d)};this.controls.chart=function(d){this.get("SHOW_CHART",d)};this.controls.calendar=function(d){this.get("SAVE_CAL",d)};this.controls.aggregate=function(d){this.get("SHOW_AGGREGATE",d)};this.controls.delete_report=function(d){this.get("SHOW_DELETE",d)};this.controls.flashback=function(d){this.get("SHOW_FLASHBACK",d)};this.controls.reset=function(d){this.get("SHOW_RESET",d)};this.controls.rename=function(d){this.get("SHOW_RENAME",d)};this.controls.row=function(d){this.get("SHOW_DETAIL",d)};this.controls.computation=function(d){d=(d)?d:b.dialog.id;this.get("SHOW_COMPUTATION",d);b.dialog.id=false};this.controls.download=function(d){this.get("SHOW_DOWNLOAD",d)};this.controls.info=function(d){this.get("INFO",b.current_col_id)};this.controls.ctrl_break=function(d){this.get("SHOW_CTRL_BREAK",d)};this.highlight={};this.highlight.clear=function(d){b.action("CLEAR_HIGHLIGHT",false,$nvl(d,$x("HIGHLIGHT_ID").value))};this.highlight.toggle=function(e,d){b.action("TOGGLE_HIGHLIGHT",false,d,(e.checked)?"Y":"N")};this.highlight.save=function(f){var d=b.dialog.validate();if(!d){return}b.supress_update=true;var e=["apexir_HIGHLIGHT_ID","apexir_HIGHLIGHT_NAME",d.col,d.col_opt,d.form_items[0],d.form_items[1],"apexir_EXPR3","apexir_HIGHLIGHT_SEQUENCE","apexir_HIGHLIGHT_ENABLED","apexir_HIGHLIGHT_TYPE","apexir_BG_COLOR","apexir_FONT_COLOR"];b.get.AddArrayItems(e,1);b.action("SAVE_HIGHLIGHT");d=null;return};this.navigate={};this.navigate.paginate=function(d){b.get.addParam("p_widget_num_return",d.split("max_rows=")[1].split("rows_fetched")[0]);b.action("PAGE",d)};this.column={};this.column.pOb=this;this.column.break_on=function(d){if(d){b.current_col_id=d}b.action("BREAK",false,b.current_col_id)};this.column.break_toggle=function(e,d){b.action("BREAK_TOGGLE",false,d,(e.checked)?"Y":"N")};this.column.hide=function(e){var d=(!!e)?e:b.current_col_id;b.action("HIDE",false,d)};this.column.filter=function(g){var d="ADD";if(g){b.current_col_id=g;d="UPDATE"}else{g=$v("apexir_COLUMN_NAME")}var e=b.dialog.validate();if(!e){return}var f=[e.col,e.col_opt,e.form_items[0],e.form_items[1],"apexir_EXPR3"];b.get.AddArrayItems(f,1);b.supress_update=true;b.action("FILTER",d,g)};this.column.filter_delete=function(d){b.action("FILTER_DELETE",false,d)};this.column.filter_toggle=function(e,d){b.action("FILTER_TOGGLE",false,d,(e.checked)?"Y":"N")};this.column.display=function(f){var e=[];var d=$x("apexir_shuttle2").getElementsByTagName("SELECT")[0];for(i=0,len=d.options.length;i<len;i++){e[e.length]=d.options[i].value}b.get.AddArray(e,1);b.action("SET_COLUMNS")};this.column.order=function(j){if(j=="ASC"||j=="DESC"){b.get.addParam("f01",b.last_col_id);b.get.addParam("f02",j);b.action("COLUMN_ORDER")}else{var h=["apexir_COLUMN_01","apexir_COLUMN_02","apexir_COLUMN_03","apexir_COLUMN_04","apexir_COLUMN_05","apexir_COLUMN_06"];var g=["apexir_ASCENDING_01","apexir_ASCENDING_02","apexir_ASCENDING_03","apexir_ASCENDING_04","apexir_ASCENDING_05","apexir_ASCENDING_06"];var f=["apexir_NULLS_01","apexir_NULLS_02","apexir_NULLS_03","apexir_NULLS_04","apexir_NULLS_05","apexir_NULLS_06"];for(var e=0,d=h.length;e<d;e++){if($x(h[e]).value!="0"){b.get.addParam("f01",$v(h[e]));b.get.addParam("f02",$v(g[e]));b.get.addParam("f03",$v(f[e]))}}b.action("SORT")}};this.column.break_save=function(h){if(h=="ENABLE"||h=="DISABLE"){b.get.addParam("f01",b.last_col_id);b.get.addParam("f02",h)}else{var g=["apexir_COLUMN_01","apexir_COLUMN_02","apexir_COLUMN_03","apexir_COLUMN_04","apexir_COLUMN_05","apexir_COLUMN_06"];var f=["apexir_ENABLE_01","apexir_ENABLE_02","apexir_ENABLE_03","apexir_ENABLE_04","apexir_ENABLE_05","apexir_ENABLE_06"];for(var e=0,d=g.length;e<d;e++){if($x(g[e]).value!="0"){b.get.addParam("f01",$v(g[e]));b.get.addParam("f02",$v(f[e]))}}}b.action("SAVE_BREAK")};this.flashback={};this.flashback.save=function(){b.supress_update=true;b.action("FLASHBACK_SET",false,false,$v("apexir_FLASHBACK_TIME"))};this.flashback.clear=function(){b.action("FLASHBACK_CLEAR",false,false,false)};this.flashback.toggle=function(){b.action("FLASHBACK_TOGGLE",false,false,false)};this.aggregate={};this.aggregate.control=function(){if($v("apexir_AGGREGATE_BY")=="COUNT"){$x_Show_Hide("ALL_COLUMNS","NUMBER_COLUMNS")}else{$x_Show_Hide("NUMBER_COLUMNS","ALL_COLUMNS")}};this.aggregate.save=function(){var d=($v("apexir_AGGREGATE_BY")=="COUNT")?$v("apexir_COLUMN_NAME_ALL"):$v("apexir_COLUMN_NAME");b.action("SAVE_AGGREGATE",false,$v("apexir_AGGREGATION"),$v("apexir_AGGREGATE_BY"),d)};this.aggregate.clear=function(){b.action("DELETE_AGGREGATE",false,$v("apexir_AGGREGATION"))};this.aggregate.toggle=function(){};this.computation={};this.computation.save=function(){var d=$f_get_emptys(["apexir_COLUMN_LABEL","apexir_COMPUTATION_EXPR"],"error","");if(!!d){return}b.supress_update=true;b.action("SAVE_COMPUTATION",false,$v("apexir_COMPUTATION_ID"),$v("apexir_COLUMN_LABEL"),$v("apexir_REPORT_LABEL"),$v("apexir_FORMAT_MASK"),$v("apexir_COMPUTATION_EXPR"))};this.computation.clear=function(){b.action("DELETE_COMPUTATION",false,$v("apexir_COMPUTATION_ID"))};this.computation.toggle=function(){};this.chart={};this.chart.control=function(e){var d=[];d[0]=$x("apexir_LABEL_AXIS_TITLE").parentNode;d[1]=$x("apexir_VALUE_AXIS_TITLE").parentNode;d[2]=d[0].previousSibling;d[3]=d[1].previousSibling;if($x("apexir_CHART_TYPE_2").checked){$x_Hide(d)}else{$x_Show(d)}};this.chart.save=function(){var d=["apexir_CHART_TYPE","apexir_CHART_LABEL","apexir_CHART_VALUE","apexir_AGGREGATE_BY","apexir_LABEL_AXIS_TITLE","apexir_VALUE_AXIS_TITLE","apexir_SORT"];b.get.AddArrayItems(d,1);b.action("SAVE_CHART")};this.chart.clear=function(){b.action("DELETE_CHART")};this.chart.view=function(){b.action("VIEW_CHART",false,false)};this.calendar={};this.calendar.save=function(){b.action("SAVE_CALENDAR",false,false,$v("DATE_COLUMN"),$v("DISPLAY_COLUMN"))};this.calendar.view=function(){b.action("VIEW_CALENDAR",false,false)};this.data={};this.data.view=function(){b.action("VIEW_REPORT",false,false)};this.detail={};this.detail.last_row_opened=false;this.detail.show=function(d){if(b.ajax_busy){return}$x_Show(getElementsByClass("displayed"));$x_Show(getElementsByClass("other"));if($x("apexir_EXCLUDE_NULL_0").checked&&$x("apexir_DISPLAY_OPTION").checked){$x_Hide(getElementsByClass("null"));$x_Hide(getElementsByClass("other"))}else{if($x("apexir_EXCLUDE_NULL_0").checked){$x_Hide(getElementsByClass("null"))}else{if($x("apexir_DISPLAY_OPTION").checked){$x_Hide(getElementsByClass("other"))}}}b.l_Action="CHANGE_DETAIL_OPTION";b.supress_update=true;b.action("CHANGE_DETAIL_OPTION",false,false,$v("apexir_EXCLUDE_NULL_0"),$v("apexir_DISPLAY_OPTION"))};this.remove=function(){b.action("DELETE",false,false,false)};this.reset=function(){b.action("RESET",false,false,false)};this.save=function(f){var e=$x("create_category");var d=$f_get_emptys(["apexir_WORKSHEET_NAME"],"error","");if(e){d=$f_get_emptys([e],"error","")}if(!!d){return}l_cat=(e)?e.value:$v("apexir_WORKSHEET_CATEGORY");f=(!!f)?"RENAME":"SAVE";b.action(f,false,false,$v("apexir_WORKSHEET_NAME"),l_cat,$v("apexir_PUBLIC"),$v("apexir_DESCRIPTION"),$v("apexir_IS_DEFAULT"))};this.save_default=function(){b.action("SAVE_DEFAULT",false,false,false)};this.save_category_check=function(d){if(d.value=="new"){$dom_AddInput(d.parentNode,"text","create_category","")}else{$x_Remove("create_category")}};this.pull=function(d){if(!!d){b.report_id=d}b._Get("PULL")};this.download=function(d){};this.search=function(j){var h=b.item.search();var e=b.item.search_column();var f=$v("apexir_REPORT_ID");var g;if(j="SEARCH"){b.get.addParam("p_widget_num_return",$v("apexir_NUM_ROWS"));if(!!b.external_items){var d=b.external_items.split(",");b.get.AddPageItems(d)}}if($v_IsEmpty(h)){b.pull(f)}else{if(j="SEARCH"){g=[$v("apexir_CURRENT_SEARCH_COLUMN"),"contains",$v(h),$v("apexir_NUM_ROWS")];j="QUICK_FILTER"}else{g=[this.current_col_id,"=",$v(h),$v("apexir_NUM_ROWS")];j="FILTER"}b.get.AddArray(g,1);b.action(j,"ADD")}$s(h,"")};this.valid_action=function(d){if(d=="true"){b.pull()}else{$s("apexir_DIALOG_MESSAGE",d)}};this.action=function(n,d,k,m,l,j,h,g,e,f){b.l_Action=n;b._Get("ACTION",n,d,k,m,l,j,h,g,e,f)};this._Get=function(h,o,d,l,n,m,k,j,g,e,f){if(b.ajax_busy){return}else{b.ajax_busy=true}b.get.addParam("p_widget_name","worksheet");(!!h)?b.get.addParam("p_widget_mod",h):null;(!!o)?b.get.addParam("p_widget_action",o):null;(!!d)?b.get.addParam("p_widget_action_mod",d):null;b.get.addParam("x01",$v("apexir_WORKSHEET_ID"));(!!b.report_id)?b.get.addParam("x02",b.report_id):"0";(!!l)?b.get.addParam("x03",l):null;(!!n)?b.get.addParam("x04",n):null;(!!m)?b.get.addParam("x05",m):null;(!!k)?b.get.addParam("x06",k):null;(!!j)?b.get.addParam("x07",j):null;(!!g)?b.get.addParam("x08",g):null;(!!e)?b.get.addParam("x09",e):null;(!!f)?b.get.addParam("x10",f):null;b.get.GetAsync(b._Return)};this._Loading=function(){$x_Hide("apexir_rollover");b._BusyGraphic(p.readyState);return};this._Finished_Loading=function(){b._BusyGraphic(p.readyState);if(ie){if(!!!b.lCSS){b.lCSS=document.createStyleSheet()}startTag='<style id="apexir_WORKSHEET_CSS" type="text/css">';endTag="</style>";var f=p.responseText.indexOf(startTag);var e=p.responseText.substring(f+startTag.length);var d=e.indexOf(endTag);e=e.substring(0,d);b.lCSS.cssText=e}document.onclick=null;b.init();if(!!b.l_LastFunction){b.l_LastFunction();b.l_LastFunction=false}b.ajax_busy=false;return};this._BusyGraphic=function(d){if(d==1){$x_Show("apexir_LOADER")}else{$x_Hide("apexir_LOADER")}return};this._Return=function(){if(p.readyState==1){b._Loading()}else{if(p.readyState==2){}else{if(p.readyState==3){}else{if(p.readyState==4){$x_Hide("searchdrop").innerHTML="";if(b.l_Action=="CONTROL"){if(b.current_control=="COL_LOV"){var m=new $d_LOV_from_JSON();m.l_Type="SELECT";m.create(gReport.controls.lov_dom,p.responseText);$s(m.l_Dom,gReport.controls.value);m.l_Dom.focus();m.l_Dom.onblur=function(l){cellsave(l,this)}}else{if(b.current_control=="SORT_WIDGET"){var j=$u_eval("("+p.responseText+")");b.dialog.id=j.dialog.id;var e=$x("apexir_rollover").getElementsByTagName("TABLE")[0];$x_Show_Hide([e,"apexir_sortup","apexir_sortdown","apexir_removefilter","apexir_hide","apexir_break","apexir_info","apexir_computation"],j.dialog.hide);$x_Hide(j.dialog.hide);if(j.dialog.uv){var k=j.dialog.row.length;for(var g=0;g<k;g++){if(j.dialog.row[g].R!=null){if(j.dialog.row[g].D!=null){var h=j.dialog.row[g].D}else{var h=j.dialog.row[g].R}var o=$dom_AddTag("apexir_rollover_content","a",h);o.apexir_RETURN_VALUE=j.dialog.row[g].R;o.href="javascript:void(false);";o.onclick=function(){var l=[b.current_col_id,"=",this.apexir_RETURN_VALUE,"",""];b.get.AddArray(l,1);b._Get("ACTION","QUICK_FILTER")}}}if(k>10){$x_Style("apexir_rollover_content","height","210px")}else{$x_Style("apexir_rollover_content","height","")}$x_Show("apexir_rollover_content");$s("apexir_search","")}else{$x_Hide("apexir_rollover_content")}var f=$x(b.current_col_dom);$x_Show("apexir_rollover");$x_Style("apexir_rollover","left",(findPosX(f.parentNode))+"px");$x_Style("apexir_rollover","top",(findPosY(f)+f.offsetHeight+5)+"px");$x_Class(f.parentNode,"current");b.last_col_id=f.id;document.body.onclick=b.dialog.check}else{if(b.current_control=="SHOW_FILTER"||b.current_control=="SHOW_HIGHLIGHT"){var d=b.item.control_panel_drop();$s(d,p.responseText);$x_Show(d);ws_ColumnCheck($x("apexir_COLUMN_NAME"))}else{if(b.current_control=="NARROW"||b.current_control=="FORMAT_MASK_LOV"){var m=new $d_LOV_from_JSON();m.l_Type="a";m.create(r,p.responseText);m.l_Dom.id="apexir_col_values_drop";$x_Style(m.l_Dom,"height","200px");$x_Style(m.l_Dom,"display","block");if(!$x("apexir_col_values_drop_space")){lThis=$dom_AddTag($x(b.temp_return_element).parentNode,"BR");lThis.id="apexir_col_values_drop_space"}$x(b.temp_return_element).parentNode.appendChild(m.l_Dom);for(var g=0,k=m.l_NewEls.length;g<k;g++){o=m.l_NewEls[g];o.href="javascript:void(false)";if(b.current_control=="NARROW"){o.onclick=function(){var l=$x("apexir_COLUMN_NAME");var s=$x("apexir_"+l.options[l.selectedIndex].className+"_OPT");var t=$v(s);if(t=="in"||t=="not in"){t=$v(b.temp_return_element);$s(b.temp_return_element,(isEmpty(b.temp_return_element))?this.id:t+","+this.id)}else{$s(b.temp_return_element,this.id);$x_Remove("apexir_col_values_drop")}}}else{o.onclick=function(){$s(b.temp_return_element,this.id);$x_Remove("apexir_col_values_drop")}}}b.supress_update=false;b.l_Action=false;document.body.onclick=b.dialog.check2}else{if(b.current_control=="INFO"){var e=$x("apexir_rollover").getElementsByTagName("TABLE")[0];$x_Hide(e);$s("apexir_rollover_content",p.responseText);$x_Style("apexir_rollover_content","height","");var f=$x(b.current_col_dom);$x_Show("apexir_rollover");$x_Style("apexir_rollover","left",(findPosX(f.parentNode))+"px");$x_Style("apexir_rollover_content","top",(findPosY(f)+f.offsetHeight+5)+"px");$x_Class(f.parentNode,"current");b.last_col_id=f.id;document.body.onclick=b.dialog.check}else{if(b.current_control=="SEARCH_COLUMN"){var r=$x("apexir_SEARCHDROP");$s(r,"");var m=new $d_LOV_from_JSON();m.l_Type="a";m.create(r,p.responseText);m.l_Dom.id="apexir_columnsearch";var n=b.item.search_column();for(var g=0,k=m.l_NewEls.length;g<k;g++){m.l_NewEls[g].href="javascript:void(0)";m.l_NewEls[g].onclick=function(){if(this.id!=0){$s("apexir_SEARCH_COLUMN_DROP",this.innerHTML+"");$s(n,this.id)}else{$s("apexir_SEARCH_COLUMN_DROP","");$s(n,"")}$x_Hide(r)}}$x_Show(r);document.body.onclick=b.dialog.check}else{if(b.current_control=="SHOW_DETAIL"){$x_Hide(b.item.worksheet_report());$s("apexir_DATA_PANEL","");$s("apexir_CONTROL_PANEL_DROP","");$s(b.item.worksheet_detail(),p.responseText);$x_Show(b.item.worksheet_detail())}else{var d=b.item.control_panel_drop();d.innerHTML=p.responseText;if(b.current_control=="SHOW_CHART"){b.chart.control()}if(b.controls.set){$s("apexir_COLUMN_NAME",b.last_col_id);$s("apexir_EXPR",$v("apexir_SEARCH"));b.controls.set=false;$s("apexir_SEARCH","")}if(b.current_control=="SHOW_COLUMN"){window.g_Shuttlep_v01=null;if(!q){var q=[]}q[2]=$x("apexir_SHUTTLE_LEFT");q[1]=$x("apexir_SHUTTLE_RIGHT");window.g_Shuttlep_v01=new dhtml_ShuttleObject(q[2],q[1])}$x_Show(d)}}}}}}}}else{if(b.supress_update){if(b.l_Action=="SAVE_COMPUTATION"||b.l_Action=="FLASHBACK_SET"||b.l_Action=="SAVE_HIGHLIGHT"||b.l_Action=="FILTER"){b.l_LastFunction=function(){b.valid_action(p.responseText)}}b.ajax_busy=false;b.supress_update=false;b.l_Action=false}else{b.ajax_busy=false;$x_Hide("apexir_rollover");o=$x("apexir_WORKSHEET");o.id="apexir_WORKSHEET_old";lThis=$u_js_temp_drop();$s(lThis,p.responseText);o.parentNode.replaceChild($x("apexir_WORKSHEET"),o);$d_ClearAndHide("apexir_DETAIL");$s("apexir_CURRENT_SEARCH_COLUMN","");$s("apexir_SEARCH_COLUMN_DROP","");$x_Show("apexir_REPORT");$u_js_temp_clear()}}b._Finished_Loading()}else{return false}}}}};return;function c(d){this.l_Action=false;this.l_Type=false;b.ajax_busy=false;if(!!d){b.worksheet_id=d}b.report_id=($v("apexir_REPORT_ID"))?$v("apexir_REPORT_ID"):"0";this.get=new htmldb_Get(null,$v("pFlowId"),"APXWGT",$v("pFlowStepId"))}}};apex.ajax={clob:function(b){var d=this;this.ajax=new htmldb_Get(null,$x("pFlowId").value,"APXWGT",0);this.ajax.addParam("p_widget_name","apex_utility");this.ajax.addParam("x04","CLOB_CONTENT");this._get=c;this._set=a;this._return=!!b?b:e;return;function c(f){d.ajax.addParam("x05","GET");d.ajax.GetAsync(d._return)}function a(f){d.ajax.addParam("x05","SET");d.ajax.AddArrayClob(f,1);d.ajax.GetAsync(d._return)}function e(){if(p.readyState==1){}else{if(p.readyState==2){}else{if(p.readyState==3){}else{if(p.readyState==4){return p}else{return false}}}}}},test:function(b){var d=this;this.ajax=new htmldb_Get(null,$x("pFlowId").value,"APXWGT",0);this.ajax.addParam("p_widget_name","apex_utility");this._get=c;this._set=a;this._return=!!b?b:e;return;function c(f){d.ajax.GetAsync(d._return)}function a(f){}function e(f){}},widget:function(c,b){var e=this;this.ajax=new htmldb_Get(null,$x("pFlowId").value,"APXWGT",0);this.ajax.addParam("p_widget_name",c);this._get=d;this._set=a;this._return=!!b?b:f;return;function d(g){e.ajax.GetAsync(e._return)}function a(g){}function f(g){}},ondemand:function(c,b){var e=this;this.ajax=new htmldb_Get(null,$x("pFlowId").value,"APPLICATION_PROCESS="+c,0);this._get=d;this._set=a;this._return=!!b?b:f;return;function d(g){e.ajax.GetAsync(e._return)}function a(g){}function f(g){}}};apex.tabular={table:function(h,e){var d=this;this.l_Table=$x(h);this.l_Headers=d.l_Table.rows[0].cells;this.l_Row1=d.l_Table.rows[1].cells;this.currentItem=null;this.col={};this.col.length=d.l_Headers.length;this.col.by_id=function(l){for(var k=0,j=d.col.length;k<j;k++){var m=(d.col[k].id==l);if(m){return d.col[k]}}};this.col.by_name=function(k){for(var l=0,j=d.col.length;l<j;l++){var m=(d.col[l].name==k);if(m){return d.col[l]}}};this.error=function(){d.currentItem.focus();$x_Style(d.currentItem,"border","1px solid red")};this.success=function(){$x_Style(d.currentItem,"border","")};for(var c=0,a=this.l_Headers.length;c<a;c++){var b={};b.id=this.l_Headers[c].id;var g=$x_FormItems(this.l_Row1[c],"ALL")[0];b.name=(g)?g.name:false;b.dom=this.l_Headers[c];this.col[c]=b}var f=$x_FormItems(this.l_Table,"ALL");for(var c=0,a=f.length;c<a;c++){f[c].onchange=function(){d.row.init(this,d)}}this.row={};this.row.dom;this.row.init=(e)?e:function(k,j){};this.row.cell={};this.row.cell.item=function(j){return $x_FormItems(d.row.dom.cells[d.col.by_id(j).dom.cellIndex])[0]};this.row.cell.value=function(k,j){d.row.cell.item(k)[0].value=j};this.row.cell.disable=function(k,j){$v(d.row.cell.item(k),j)}},sort:function(a){var b=this;b.class_name="pb";b.src_up=htmldb_Img_Dir+"htmldb/icons/up_arrow.gif";b.src_down=htmldb_Img_Dir+"htmldb/icons/down_arrow.gif";b.resequence=true;b.resequence_class="orderby";b.table=false;b.row={};b.row.before_move=function(){};b.row.after_move=function(){};b.row.up=function(d){return b.row.move(d,"UP")};b.row.down=function(d){return b.row.move(d,"DOWN")};b.row.top=function(){};b.row.bottom=function(){};b.row.move=function(h,d){b.row.before_move();var q=$x_UpTill(h,"TR");ie_RowFixStart(q);$tr_RowMoveFollow(q,true);var g=q.parentNode;var n=q.nextSibling;var k=q.previousSibling;if(d=="DOWN"){while(n!=null){if(n.nodeType==1){break}n=n.nextSibling}if(n!=null&&n.nodeName=="TR"){oElement=g.insertBefore(q,n.nextSibling)}else{oElement=g.insertBefore(q,g.getElementsByTagName("TR")[1])}}else{if(d=="UP"){while(k!=null){if(k.nodeType==1){break}k=k.previousSibling}if(k!=null&&k.firstChild!=null&&k.firstChild.nodeName!="TH"&&k.nodeName=="TR"){oElement=g.insertBefore(q,k)}else{oElement=g.appendChild(q)}}}ie_RowFixFinish(oElement);for(var j=1,m=g.rows.length;j<m;j++){var o=g.rows[j];var e=getElementsByClass(b.resequence_class,o,"INPUT");for(var f=0,l=e.length;f<l;f++){e[f].value=j}}b.row.after_move();return oElement};b.row.remove=function(){};b.row.add=function(){};b.init=c;if(!!a){b.init(a)}return;function c(h){b.table=$x(h);b.lH=getElementsByClass(b.resequence_class,b.table,"INPUT");this.create=f;var e=b.table.rows;for(var g=0,d=e.length;g<d;g++){if(g==0){$tr_AddTH(e[g],"<br />")}else{var l=$tr_AddTD(e[g]);var k=this.create(l,b.src_up,b.class_name,function(){b.row.up(this)});var j=this.create(l,b.src_down,b.class_name,function(){b.row.down(this)})}}return;function f(r,q,n,m){var o=$dom_AddTag(r,"IMG");o.src=q;o.className=n;o.onclick=m;return o}}}};function ws_OperatorCheck(d){var b=$x("apexir_COLUMN_NAME").options[$x("apexir_COLUMN_NAME").selectedIndex].className;var a=$v(d);var c=[];c[0]=$x("apexir_EXPR").parentNode;c[1]=$x("apexir_EXPR2").parentNode;c[2]=$x("apexir_EXPR3").parentNode;c[3]=$x("apexir_BETWEEN_FROM_fieldset").parentNode;c[4]=$x("apexir_BETWEEN_TO_fieldset").parentNode;$x_Show_Hide("apexir_EXPR_ICON",c);if(a=="is null"||a=="is not null"){$x_Hide("apexir_EXPRESSION_LABEL");return}else{$x_Show("apexir_EXPRESSION_LABEL");if(b=="DATE"&&!(a=="is in the last"||a=="is not in the last"||a=="is in the next"||a=="is not in the next")){$x_Show(c[3]);(a=="between")?$x_Show(c[4]):null}else{$x_Show(c[0]);(a=="between")?$x_Show(c[1]):null;(a=="is in the last"||a=="is not in the last"||a=="is in the next"||a=="is not in the next")?$x_Show_Hide(c[2],"apexir_EXPR_ICON"):null}}return}function ws_ColumnCheck(b){var a=b.options[b.selectedIndex].className;$x_HideSiblings("apexir_"+a+"_OPT");ws_OperatorCheck("apexir_"+a+"_OPT")}function item_menu(f,b){$x_Style("item_menu","position","absolute");var d=$x("item_menu").getElementsByTagName("a");for(var c=0,a=d.length;c<a;c++){var e=d[c].href;e=e.split(":");e[e.length-1]=b;d[c].href=$u_ArrayToString(e,":")}dhtml_ButtonDropDown(f,"item_menu");$x_Show("item_menu")}function comp(a){lSpace=(!(isNaN(a))||a==".");html_ReturnToTextSelection(a,"apexir_COMPUTATION_EXPR",lSpace)}function ajax_calendar(c,f,h){var k=$v("p_cal_type_field_id");var e=$v("p_cal_date_field_id");var g=$v("p_calendar_id");var b="calendar"+g;$s(e,$v("p_calendar_date"));var j=new apex.ajax.widget("calendar",function(){if(p.readyState==1){document.body.style.cursor="wait"}else{if(p.readyState==2){}else{if(p.readyState==3){}else{if(p.readyState==4){$x(b).innerHTML=p.responseText;$s(e,$v("p_calendar_date"));document.body.style.cursor=""}else{return false}}}}});if(c=="S"){c=$v("p_calendar_type")}else{$s(k,c)}j.ajax.addParam("p_widget_mod",c);j.ajax.addParam("p_widget_action",f);j.ajax.addParam("x01",g);var d=(!!h&&h!=="")?h:$v(e);j.ajax.add(e,d);j.ajax.addParam("x02",d);j.ajax.add(k,c);j._get()};